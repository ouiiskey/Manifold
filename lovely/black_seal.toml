[manifest]
version = "1.0.0"
dump_lua = true
priority = 0

# Functionality
[[patches]]
[patches.pattern]
target = "card.lua"
pattern = "if self.area then self.area:remove_card(self) end"
position = "before"
match_indent = true
payload = '''
if (self.area == G.hand or self.area == G.play) and not self.debuff and self.seal == "manifold_black" then
    for i = 1, math.min(self.ability.seal.extra.spectrals, G.consumeables.config.card_limit - #G.consumeables.cards) do
        G.E_MANAGER:add_event(Event({trigger = "before", delay = 0.0, func = function()
            if G.consumeables.config.card_limit > #G.consumeables.cards then
                SMODS.add_card{set = "Spectral", area = G.consumeables, key_append = "blk"}
            end
        return true end }))
    end
end
'''

# Color
[[patches]]
[patches.pattern]
target = "functions/misc_functions.lua"
pattern = "red = G.C.RED,"
position = "before"
match_indent = true
payload = '''
manifold_black = G.C.BLACK,
'''